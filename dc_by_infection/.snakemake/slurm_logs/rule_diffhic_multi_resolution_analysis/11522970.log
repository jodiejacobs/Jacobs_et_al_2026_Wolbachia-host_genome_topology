host: phoenix-12.prism
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided remote nodes: 1
Provided resources: mem_mb=200000, mem_mib=190735, disk_mb=22354, disk_mib=21319
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 22 15:17:15 2025]
rule diffhic_multi_resolution_analysis:
    input: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18DOX_contacts.tsv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18wMel_contacts.tsv
    output: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/all_results_combined.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/analysis_summary.txt, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/null_model_results.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_1000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_8000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_32000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_128000/differential_interactions_infectionJW18wMel.csv
    jobid: 0
    reason: Forced execution
    threads: 32
    resources: mem_mb=200000, mem_mib=190735, disk_mb=22354, disk_mib=21319, tmpdir=<TBD>, slurm_partition=medium, runtime=480

host: phoenix-12.prism
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 32
Rules claiming more threads will be scaled down.
Provided resources: mem_mb=200000, mem_mib=190735, disk_mb=22354, disk_mib=21319
Select jobs to execute...
Execute 1 jobs...

[Mon Sep 22 15:17:16 2025]
localrule diffhic_multi_resolution_analysis:
    input: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18DOX_contacts.tsv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18wMel_contacts.tsv
    output: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/all_results_combined.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/analysis_summary.txt, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/null_model_results.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_1000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_8000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_32000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_128000/differential_interactions_infectionJW18wMel.csv
    jobid: 0
    reason: Forced execution
    threads: 32
    resources: mem_mb=200000, mem_mib=190735, disk_mb=22354, disk_mib=21319, tmpdir=/data/tmp, slurm_partition=medium, runtime=480

Using parameters:
  Data directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts 
  Resolutions: 1000, 8000, 32000, 128000 bp
  Min count: 10 
  Min samples: 2 
  FDR threshold: 0.01 
  Output directory: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results 
  Reference level: DOX 
  Threads: 32 

=======================================================
Processing resolution: 1000 bp
=======================================================
Found contact files: JW18DOX_contacts.tsv, JW18wMel_contacts.tsv 
Processing file: JW18DOX_contacts.tsv for resolution 1000 bp
  - Found 333420 interactions for JW18DOX_rep1 
Processing file: JW18wMel_contacts.tsv for resolution 1000 bp
  - Found 996091 interactions for JW18wMel_rep1 
  - Found 3699744 interactions for JW18wMel_rep2 
Creating combined interaction set...
Finding all unique interactions across samples...
Processing JW18DOX_rep1 
Processing JW18wMel_rep1 
Processing JW18wMel_rep2 
Found 4077993 unique interactions
Filling count matrix using a faster approach...
Processing sample 1 of 3 
  Processing chunk 1 of 4 
  Processing chunk 2 of 4 
  Processing chunk 3 of 4 
  Processing chunk 4 of 4 
Processing sample 2 of 3 
  Processing chunk 1 of 10 
  Processing chunk 2 of 10 
  Processing chunk 3 of 10 
  Processing chunk 4 of 10 
  Processing chunk 5 of 10 
  Processing chunk 6 of 10 
  Processing chunk 7 of 10 
  Processing chunk 8 of 10 
  Processing chunk 9 of 10 
  Processing chunk 10 of 10 
Processing sample 3 of 3 
  Processing chunk 1 of 37 
  Processing chunk 2 of 37 
  Processing chunk 3 of 37 
  Processing chunk 4 of 37 
  Processing chunk 5 of 37 
  Processing chunk 6 of 37 
  Processing chunk 7 of 37 
  Processing chunk 8 of 37 
  Processing chunk 9 of 37 
  Processing chunk 10 of 37 
  Processing chunk 11 of 37 
  Processing chunk 12 of 37 
  Processing chunk 13 of 37 
  Processing chunk 14 of 37 
  Processing chunk 15 of 37 
  Processing chunk 16 of 37 
  Processing chunk 17 of 37 
  Processing chunk 18 of 37 
  Processing chunk 19 of 37 
  Processing chunk 20 of 37 
  Processing chunk 21 of 37 
  Processing chunk 22 of 37 
  Processing chunk 23 of 37 
  Processing chunk 24 of 37 
  Processing chunk 25 of 37 
  Processing chunk 26 of 37 
  Processing chunk 27 of 37 
  Processing chunk 28 of 37 
  Processing chunk 29 of 37 
  Processing chunk 30 of 37 
  Processing chunk 31 of 37 
  Processing chunk 32 of 37 
  Processing chunk 33 of 37 
  Processing chunk 34 of 37 
  Processing chunk 35 of 37 
  Processing chunk 36 of 37 
  Processing chunk 37 of 37 
Creating GInteractions object...
Creating final InteractionSet...
Count matrix summary: 0 0 0 18.43145 14 93213 
Non-zero entries: 5029255 
Combined interaction set has 4077993 interactions across 3 samples
Filtering low-abundance interactions...
Filtered from 4077993 to 951262 interactions
Creating DGEList object for analysis...
                     sample infection replicate
JW18DOX_rep1   JW18DOX_rep1   JW18DOX         1
JW18wMel_rep1 JW18wMel_rep1  JW18wMel         1
JW18wMel_rep2 JW18wMel_rep2  JW18wMel         2
Creating model matrix for infection effect...
              (Intercept) infectionJW18wMel
JW18DOX_rep1            1                 0
JW18wMel_rep1           1                 1
JW18wMel_rep2           1                 1
attr(,"assign")
[1] 0 1
attr(,"contrasts")
attr(,"contrasts")$infection
[1] "contr.treatment"

Calculating normalization factors...
Error in hclust(d, method = method) : 
  NA/NaN/Inf in foreign function call (arg 10)
Calls: process_resolution -> pheatmap -> cluster_mat -> hclust
In addition: Warning messages:
1: In fread(file, header = TRUE) :
  Stopped early on line 8341459. Expected 11 fields but found 7. Consider fill=TRUE and comment.char=. First discarded non-empty line: <<0	22677000	2	2	JW18DOX	cis	1000>>
2: In process_resolution(res) :
  Reference level DOX not found in data. Using alphabetical order for conditions.
3: In max(abs(logR)) : no non-missing arguments to max; returning -Inf
4: In cor(logcounts) : the standard deviation is zero
Execution halted
RuleException:
CalledProcessError in file "/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/Snakefile", line 85:
Command 'set -euo pipefail;  
        source $(dirname $(dirname $(which conda)))/etc/profile.d/conda.sh
        conda activate /private/home/jomojaco/miniforge3/envs/diffhic

        Rscript scripts/analyze_multi_resolution_3.R         --data_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts         --output_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results         --resolutions=1000,8000,32000,128000         --threads=32         --reference=DOX         --min_count=10         --fdr=0.01' returned non-zero exit status 1.
[Mon Sep 22 15:20:08 2025]
Error in rule diffhic_multi_resolution_analysis:
    message: None
    jobid: 0
    input: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18DOX_contacts.tsv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18wMel_contacts.tsv
    output: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/all_results_combined.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/analysis_summary.txt, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/null_model_results.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_1000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_8000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_32000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_128000/differential_interactions_infectionJW18wMel.csv
    shell:
        
        source $(dirname $(dirname $(which conda)))/etc/profile.d/conda.sh
        conda activate /private/home/jomojaco/miniforge3/envs/diffhic

        Rscript scripts/analyze_multi_resolution_3.R         --data_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts         --output_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results         --resolutions=1000,8000,32000,128000         --threads=32         --reference=DOX         --min_count=10         --fdr=0.01
        
        (command exited with non-zero exit code)
Shutting down, this might take some time.
Exiting because a job execution failed. Look below for error messages
[Mon Sep 22 15:20:08 2025]
Error in rule diffhic_multi_resolution_analysis:
    message: None
    jobid: 0
    input: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18DOX_contacts.tsv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18wMel_contacts.tsv
    output: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/all_results_combined.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/analysis_summary.txt, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/null_model_results.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_1000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_8000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_32000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_128000/differential_interactions_infectionJW18wMel.csv
    shell:
        
        source $(dirname $(dirname $(which conda)))/etc/profile.d/conda.sh
        conda activate /private/home/jomojaco/miniforge3/envs/diffhic

        Rscript scripts/analyze_multi_resolution_3.R         --data_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts         --output_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results         --resolutions=1000,8000,32000,128000         --threads=32         --reference=DOX         --min_count=10         --fdr=0.01
        
        (command exited with non-zero exit code)
Storing output in storage.
WorkflowError:
At least one job did not complete successfully.
srun: error: phoenix-12: task 0: Exited with exit code 1
[Mon Sep 22 15:20:08 2025]
Error in rule diffhic_multi_resolution_analysis:
    message: None
    jobid: 0
    input: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18DOX_contacts.tsv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18wMel_contacts.tsv
    output: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/all_results_combined.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/analysis_summary.txt, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/null_model_results.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_1000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_8000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_32000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_128000/differential_interactions_infectionJW18wMel.csv
    shell:
        
        source $(dirname $(dirname $(which conda)))/etc/profile.d/conda.sh
        conda activate /private/home/jomojaco/miniforge3/envs/diffhic

        Rscript scripts/analyze_multi_resolution_3.R         --data_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts         --output_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results         --resolutions=1000,8000,32000,128000         --threads=32         --reference=DOX         --min_count=10         --fdr=0.01
        
        (command exited with non-zero exit code)
Shutting down, this might take some time.
Exiting because a job execution failed. Look below for error messages
[Mon Sep 22 15:20:09 2025]
Error in rule diffhic_multi_resolution_analysis:
    message: None
    jobid: 0
    input: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18DOX_contacts.tsv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts/JW18wMel_contacts.tsv
    output: /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/all_results_combined.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/analysis_summary.txt, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/summary/null_model_results.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_1000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_8000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_32000/differential_interactions_infectionJW18wMel.csv, /private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results/res_128000/differential_interactions_infectionJW18wMel.csv
    shell:
        
        source $(dirname $(dirname $(which conda)))/etc/profile.d/conda.sh
        conda activate /private/home/jomojaco/miniforge3/envs/diffhic

        Rscript scripts/analyze_multi_resolution_3.R         --data_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/contacts         --output_dir=/private/groups/russelllab/jodie/wolbachia_induced_DE/Jacobs_et_al_2026_Wolbachia-host_genome_topology/dc_by_infection/results/diffhic_results         --resolutions=1000,8000,32000,128000         --threads=32         --reference=DOX         --min_count=10         --fdr=0.01
        
        (command exited with non-zero exit code)
Storing output in storage.
WorkflowError:
At least one job did not complete successfully.
